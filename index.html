<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="color-scheme" content="dark only" />
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="0" />
  <title>/// TRANSMISJA ///</title>
  <style>
    :root{ --bg:#000; --ink:#e5ffe5; --accent:#ff2b2b; --ok:#00ff88; --cyan:#00c8ff; }
    html,body{height:100%;margin:0;background:var(--bg);font-family:"Courier New",ui-monospace,monospace;overflow:hidden;}

    /* CRT vibe */
    body::before{content:"";position:fixed;inset:-2vmax;z-index:100;pointer-events:none;
      background:radial-gradient(ellipse at center,rgba(0,0,0,0)58%,rgba(0,0,0,.5)90%,rgba(0,0,0,.95)100%);
      mix-blend-mode:multiply;filter:blur(1px);}
    body::after{content:"";position:fixed;inset:-1vmax;z-index:101;pointer-events:none;
      background:radial-gradient(100% 120% at 50% 0%,rgba(255,255,255,.05),transparent 60%),
                 radial-gradient(100% 120% at 50% 100%,rgba(255,255,255,.03),transparent 60%);
      opacity:.22;mix-blend-mode:overlay;animation:bulge 8s ease-in-out infinite;}
    @keyframes bulge{0%,100%{transform:perspective(1200px) rotateX(.6deg)}50%{transform:perspective(1200px) rotateX(-.6deg)}}

    /* Tap-to-start (audio permissions) */
    .gate{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;flex-direction:column;gap:14px;background:#000;z-index:999;color:#cfd;letter-spacing:.04em;text-align:center;transition:opacity .5s ease;}
    .gate .ring{width:120px;height:120px;border:1px dashed #0f8;border-radius:50%;display:grid;place-items:center;box-shadow:0 0 24px rgba(0,255,136,.15) inset;}
    .gate .hint{opacity:.82;font-size:clamp(1rem,3.4vw,1.2rem);text-shadow:0 0 10px rgba(0,255,136,.25);}
    .gate .mini{opacity:.6;font-size:.85rem}
    .gate.off{opacity:0;pointer-events:none}

    /* Stage */
    .frame{position:relative;height:100dvh;width:100vw;display:flex;align-items:center;justify-content:center;
      padding:6vh 6vw;box-sizing:border-box;filter:contrast(1.02) saturate(0.88);animation:subtle-flick 6.8s infinite, wobble 6.2s ease-in-out infinite;z-index:2;}
    .frame::before{content:"";position:absolute;inset:0;background:repeating-linear-gradient(to bottom,rgba(255,255,255,0.03)0 1px,transparent 2px 3px);mix-blend-mode:overlay;pointer-events:none;}
    .frame::after{content:"";position:absolute;inset:-2vmax;background:radial-gradient(ellipse at center,rgba(0,0,0,.06)38%,rgba(0,0,0,.6)78%,rgba(0,0,0,.96)100%);pointer-events:none;}
    @keyframes subtle-flick{0%,92%,100%{filter:contrast(1.02)}93%{filter:contrast(1.2) brightness(1.06)}}
    @keyframes wobble{0%,100%{transform:skewX(0deg)}50%{transform:skewX(.35deg)}}

    .moire{position:fixed;inset:0;pointer-events:none;z-index:3;opacity:.08;mix-blend-mode:soft-light;filter:contrast(1.1) saturate(0.9);
      background:
        repeating-linear-gradient(0deg, rgba(255,255,255,.15) 0 1px, transparent 1px 2px),
        repeating-linear-gradient(90deg, rgba(255,255,255,.07) 0 1px, transparent 1px 2px);
      animation:roll 5.2s linear infinite;}
    @keyframes roll{0%{transform:translateY(0)}100%{transform:translateY(3px)}}

    .termwrap{position:relative;width:100%;max-width:56rem;max-height:calc(100dvh - 12vh);overflow:auto;scroll-behavior:smooth;-webkit-overflow-scrolling:touch;padding-right:4px;z-index:4;}
    .termwrap::-webkit-scrollbar{width:0;height:0}

    .terminal{position:relative;color:var(--ink);
      text-shadow:0 0 .75px var(--ink),0 0 8px rgba(0,255,0,.14),1px 0 0 rgba(255,0,0,.1),-1px 0 0 rgba(0,150,255,.1);
      line-height:1.45;font-size:clamp(.9rem,2.7vw,1.1rem);letter-spacing:.02em;transform:translateZ(0);
      opacity:0;animation:power-on 650ms ease-out forwards 350ms;filter:brightness(1.03) contrast(1.05);}
    .terminal.split{filter:contrast(1.16) saturate(1.1) drop-shadow(1px 0 0 rgba(255,0,0,.28)) drop-shadow(-1px 0 0 rgba(0,200,255,.28));}

    .static{position:fixed;inset:0;pointer-events:none;opacity:0;mix-blend-mode:screen;filter:blur(.5px);
      background-image:
        radial-gradient(1px 1px at 10% 20%,#0f0 60%,transparent 61%),
        radial-gradient(1px 1px at 70% 80%,#0f0 60%,transparent 61%),
        radial-gradient(1px 1px at 30% 60%,#0f0 60%,transparent 61%);
      animation:noise-pop 3.1s infinite;z-index:5;}
    @keyframes noise-pop{0%{opacity:0}6%{opacity:.4}8%{opacity:0}60%{opacity:.18}62%{opacity:0}100%{opacity:0}}

    .strobe{position:fixed;inset:0;pointer-events:none;opacity:0;background:radial-gradient(ellipse at center,rgba(255,0,0,.42),rgba(255,0,0,0)70%);mix-blend-mode:screen;z-index:7;}
    .strobe.flash{animation:strobe 160ms ease-out 1;}
    @keyframes strobe{0%{opacity:0}10%{opacity:1}100%{opacity:0}}
    .nosignal{position:fixed;inset:0;pointer-events:none;opacity:0;z-index:8;background:conic-gradient(from 0deg at 50% 50%,rgba(255,0,0,.1),rgba(0,255,0,.1),rgba(0,0,255,.1),rgba(255,0,0,.1));mix-blend-mode:screen;}
    .nosignal.show{animation:nosig 360ms ease-out 1;}
    @keyframes nosig{0%{opacity:0}10%{opacity:.9;transform:skewX(1.4deg)}80%{opacity:.22}100%{opacity:0}}
    .bars{position:fixed;inset:0;pointer-events:none;z-index:6;opacity:0;background:repeating-linear-gradient(to bottom,rgba(0,255,160,.16) 0 2px,rgba(0,0,0,0) 2px 6px);}
    .bars.show{animation:bars-sweep 680ms ease-out forwards;}
    @keyframes bars-sweep{0%{opacity:0;transform:translateY(-6%)}15%{opacity:1}100%{opacity:0;transform:translateY(6%)}}

    .obfuscate{animation:obf 220ms ease-in-out;}
    @keyframes obf{0%{filter:blur(1px) contrast(1.55) brightness(1.08)}100%{filter:none}}
    .tear{animation:tear 140ms steps(2,end) 1;}
    @keyframes tear{0%{transform:skewX(0deg) translateX(0)}50%{transform:skewX(2.8deg) translateX(3px)}100%{transform:skewX(0deg) translateX(0)}}
    .invertPop{filter:invert(1) hue-rotate(180deg) contrast(1.34) brightness(1.15);}

    .final{position:fixed;inset:0;background:#000;display:flex;align-items:center;justify-content:center;opacity:0;pointer-events:none;z-index:9;transition:opacity 560ms ease;}
    .final.show{opacity:1;}
    .logo{position:relative;width:min(42vw,360px);aspect-ratio:1/1;filter:drop-shadow(0 0 22px rgba(0,255,136,.7)) brightness(1.02);animation:sway 6.6s ease-in-out infinite;}
    @keyframes sway{0%,100%{transform:rotate(-1.8deg)}50%{transform:rotate(1.8deg)}}
    .invert{filter:invert(1) hue-rotate(180deg) contrast(1.3)!important;}
    .layer{position:absolute;inset:0;}
    .layer.r{mix-blend-mode:screen;filter:hue-rotate(340deg) drop-shadow(0 0 10px rgba(255,60,60,.48));transform:translate(-1px,0);opacity:.94;}
    .layer.g{mix-blend-mode:screen;filter:hue-rotate(120deg) drop-shadow(0 0 20px rgba(0,255,136,.75));transform:translate(0,0);opacity:1;}
    .layer.b{mix-blend-mode:screen;filter:hue-rotate(210deg) drop-shadow(0 0 10px rgba(0,140,255,.48));transform:translate(1px,0);opacity:.94;}
    .glitch-soft{animation:glitchShift 1.9s ease-in-out infinite;}
    .glitch-burst{animation:glitchBurst 240ms steps(2,end) 1;}
    @keyframes glitchShift{0%{transform:translate(0,0)}8%{transform:translate(-1px,0)}16%{transform:translate(1px,0)}24%{transform:translate(0,.5px)}32%{transform:translate(0,-.5px)}100%{transform:translate(0,0)}}
    @keyframes glitchBurst{0%{transform:translate(0,0) skewX(0deg);opacity:1}50%{transform:translate(-2px,0) skewX(-2.4deg);opacity:.84}100%{transform:translate(2px,0) skewX(2.4deg);opacity:1}}
    .scanline{position:absolute;left:0;right:0;height:2px;top:50%;background:rgba(255,255,255,.96);box-shadow:0 0 10px rgba(255,255,255,.9),0 0 20px rgba(180,180,180,.72);opacity:0;transform:translateY(-50%) scaleY(0.02);pointer-events:none;}
    .scanline.flash{animation:tv-line-flash 340ms ease-out 1;}
    @keyframes tv-line-flash{0%{opacity:0;transform:translateY(-50%) scaleY(0.02)}15%{opacity:1;transform:translateY(-50%) scaleY(1)}70%{opacity:1;transform:translateY(-50%) scaleY(0.03)}100%{opacity:0;transform:translateY(-50%) scaleY(0)}}

    .cursor{display:inline-block;width:.65ch;margin-left:.1ch;background:currentColor;animation:blink .85s steps(1,end) infinite;vertical-align:-2px;}
    @keyframes blink{50%{opacity:0}}
    @media (prefers-reduced-motion: reduce){ *{animation:none!important;transition:none!important;} }
  </style>
</head>
<body>
  <div class="gate" id="gate" role="button" tabindex="0" aria-label="Dotknij, aby rozpocząć">
    <div class="ring"><span class="hint">DOTKNIJ, ABY ROZPOCZĄĆ</span></div>
    <div class="mini">Włącz dźwięk, aby uzyskać pełny efekt.</div>
  </div>

  <div class="moire" aria-hidden="true"></div>

  <div class="frame" id="frame">
    <div class="termwrap" id="termwrap">
      <div class="terminal" id="term" aria-live="polite"></div>
    </div>
    <div class="static" id="static"></div>
  </div>

  <div class="strobe" id="strobe"></div>
  <div class="nosignal" id="nosig"></div>
  <div class="bars" id="bars"></div>

  <!-- Końcowy symbol -->
  <div class="final" id="final">
    <div class="logo glitch-soft" id="logo" aria-label="Znak cyrkla i węgielnicy">
      <div class="layer r">
        <svg viewBox="0 0 200 200" preserveAspectRatio="xMidYMid meet">
          <g fill="none" stroke="currentColor" stroke-width="4" stroke-linecap="round" stroke-linejoin="round" color="#ff4d4d">
            <path d="M100 20 L60 120" /><path d="M100 20 L140 120" /><circle cx="100" cy="20" r="8" />
            <path d="M60 140 L140 140 L140 160 L60 160 Z" />
            <path d="M120 100 a20 20 0 1 0 -40 0 a20 20 0 1 0 40 0" /><path d="M115 100 h-10" />
          </g>
        </svg>
      </div>
      <div class="layer g">
        <svg viewBox="0 0 200 200" preserveAspectRatio="xMidYMid meet">
          <g fill="none" stroke="currentColor" stroke-width="4" stroke-linecap="round" stroke-linejoin="round" color="#00ff88">
            <path d="M100 20 L60 120" /><path d="M100 20 L140 120" /><circle cx="100" cy="20" r="8" />
            <path d="M60 140 L140 140 L140 160 L60 160 Z" />
            <path d="M120 100 a20 20 0 1 0 -40 0 a20 20 0 1 0 40 0" /><path d="M115 100 h-10" />
          </g>
        </svg>
      </div>
      <div class="layer b">
        <svg viewBox="0 0 200 200" preserveAspectRatio="xMidYMid meet">
          <g fill="none" stroke="currentColor" stroke-width="4" stroke-linecap="round" stroke-linejoin="round" color="#00c8ff">
            <path d="M100 20 L60 120" /><path d="M100 20 L140 120" /><circle cx="100" cy="20" r="8" />
            <path d="M60 140 L140 140 L140 160 L60 160 Z" />
            <path d="M120 100 a20 20 0 1 0 -40 0 a20 20 0 1 0 40 0" /><path d="M115 100 h-10" />
          </g>
        </svg>
      </div>
      <div class="scanline" id="scanline"></div>
    </div>
  </div>

  <script>
  (() => {
    /* ===== Tekst (PL) ===== */
    const lines = [
      "Powinieneś WIEDZIEĆ o WIELE lepiej niż to...",
      "",
      "Wszystko, co próbowałem zrobić, to ci pomóc...",
      "",
      "Jeśli próbujesz mnie wrobić, to wiedz, że nie wygrasz — przerabiałem to już wiele razy, przyjacielu.",
      "",
      "Jednak ja — osobiście — WIEM o WIELE lepiej, niż żeby próbować wykiwać... :"
    ];

    /* ===== DOM ===== */
    const gate   = document.getElementById('gate');
    const frame  = document.getElementById('frame');
    const wrap   = document.getElementById('termwrap');
    const term   = document.getElementById('term');
    const staticFx = document.getElementById('static');
    const strobe = document.getElementById('strobe');
    const bars   = document.getElementById('bars');
    const final  = document.getElementById('final');
    const logo   = document.getElementById('logo');
    const scanline = document.getElementById('scanline');
    const nosig  = document.getElementById('nosig');

    /* ===== Audio ===== */
    let ac, master, humGain, clickBus, whisperBus, hissBus, radioBus, ringBus, subBus;
    let noiseBuffer=null, tickTimer=null, crackleTimer=null, sigilWhisperTimer=null, obfTimer=null;

    function bootAudio(){
      if(ac) return;
      ac = new (window.AudioContext || window.webkitAudioContext)();
      master = ac.createGain(); master.gain.value = 0.66; master.connect(ac.destination);

      // Głęboki pomruk binauralny
      const o1 = ac.createOscillator(); o1.type='sine'; o1.frequency.value=50.5;
      const o2 = ac.createOscillator(); o2.type='sine'; o2.frequency.value=58.8;
      const trem = ac.createOscillator(); trem.type='sine'; trem.frequency.value=0.2;
      humGain = ac.createGain(); humGain.gain.value=0.075;
      const tremDepth = ac.createGain(); tremDepth.gain.value=0.05;
      trem.connect(tremDepth).connect(humGain.gain);
      o1.connect(humGain); o2.connect(humGain); humGain.connect(master);
      o1.start(); o2.start(); trem.start();

      clickBus   = ac.createGain(); clickBus.gain.value=0; clickBus.connect(master);
      whisperBus = ac.createGain(); whisperBus.gain.value=0.78; whisperBus.connect(master);
      hissBus    = ac.createGain(); hissBus.gain.value=0.0; hissBus.connect(master);
      radioBus   = ac.createGain(); radioBus.gain.value=0.0; radioBus.connect(master);
      ringBus    = ac.createGain(); ringBus.gain.value=0.0; ringBus.connect(master);
      subBus     = ac.createGain(); subBus.gain.value=0.0; subBus.connect(master);

      // Bufor szumu
      noiseBuffer = ac.createBuffer(1, ac.sampleRate * 1.0, ac.sampleRate);
      const d = noiseBuffer.getChannelData(0); for(let i=0;i<d.length;i++){ d[i] = Math.random()*2-1; }

      // Głębszy "hiss"
      const hissSrc = ac.createBufferSource(); hissSrc.buffer = noiseBuffer; hissSrc.loop = true;
      const hp = ac.createBiquadFilter(); hp.type='highpass'; hp.frequency.value=900;
      const lp = ac.createBiquadFilter(); lp.type='lowpass';  lp.frequency.value=6500;
      hissSrc.connect(hp).connect(lp).connect(hissBus); hissSrc.start();
      setInterval(()=>{ if(!ac) return; const now=ac.currentTime; hissBus.gain.linearRampToValueAtTime(0.05+Math.random()*0.08, now+0.6+Math.random()*0.7); }, 1200);

      // Ring-mod ziarnistość
      const tone = ac.createOscillator(); tone.type='sine'; tone.frequency.value=340;
      const lfo  = ac.createOscillator(); lfo.type='sine';  lfo.frequency.value=28;
      const ring = ac.createGain(); ring.gain.value=0.0;
      const ringDepth = ac.createGain(); ringDepth.gain.value = 0.22;
      lfo.connect(ringDepth).connect(ring.gain);
      tone.connect(ring).connect(ringBus);
      tone.start(); lfo.start();

      function subBoom(){
        const o = ac.createOscillator(); o.type='sine'; o.frequency.setValueAtTime(56, ac.currentTime);
        const g = ac.createGain(); g.gain.value=0.0001;
        o.connect(g).connect(subBus);
        subBus.gain.setValueAtTime(1, ac.currentTime);
        g.gain.exponentialRampToValueAtTime(0.38, ac.currentTime+0.02);
        g.gain.exponentialRampToValueAtTime(0.0001, ac.currentTime+0.5);
        o.start(); o.stop(ac.currentTime+0.55);
      }
      window.__subBoom = subBoom;
    }

    function burst(vol=0.12, dur=0.08){
      if(!ac) return;
      const src = ac.createBufferSource(); src.buffer = noiseBuffer;
      const g = ac.createGain(); g.gain.value = vol;
      src.connect(g).connect(clickBus);
      clickBus.gain.cancelScheduledValues(ac.currentTime);
      clickBus.gain.setValueAtTime(1, ac.currentTime);
      src.start(ac.currentTime);
      clickBus.gain.exponentialRampToValueAtTime(0.001, ac.currentTime+dur);
    }
    function thump(){ burst(0.28, 0.12); if(window.__subBoom) window.__subBoom(); }

    function whisper({duration=1.05, cutoff=1200, q=6, gain=0.15, pan=0, trem=0.7, reverse=false}={}){
      if(!ac) return;
      const src = ac.createBufferSource(); src.buffer = noiseBuffer; src.loop = true;
      const bp = ac.createBiquadFilter(); bp.type='bandpass'; bp.frequency.value=cutoff; bp.Q.value=q;
      const g  = ac.createGain(); g.gain.value=0.0001;
      const p  = (ac.createStereoPanner) ? ac.createStereoPanner() : null;
      if(p){ p.pan.value = pan; }
      const tremOsc = ac.createOscillator(); tremOsc.type='sine'; tremOsc.frequency.value = 6 + Math.random()*2;
      const tremGain = ac.createGain(); tremGain.gain.value = trem*gain;
      tremOsc.connect(tremGain).connect(g.gain);
      src.connect(bp); (p? bp.connect(g).connect(p).connect(whisperBus): bp.connect(g).connect(whisperBus));
      const now = ac.currentTime;
      if(reverse){ g.gain.setValueAtTime(0.0001, now); g.gain.exponentialRampToValueAtTime(gain, now + duration*0.6); g.gain.exponentialRampToValueAtTime(0.0001, now + duration); }
      else{ g.gain.setValueAtTime(0.0001, now); g.gain.exponentialRampToValueAtTime(gain, now + 0.09); g.gain.exponentialRampToValueAtTime(0.0001, now + duration); }
      bp.frequency.setValueAtTime(cutoff, now); bp.frequency.linearRampToValueAtTime(cutoff*(0.9+Math.random()*0.18), now+duration);
      src.start(now); tremOsc.start(now); src.stop(now+duration+0.05); tremOsc.stop(now+duration+0.05);
    }

    function radioSweep(){
      if(!ac) return;
      const src = ac.createBufferSource(); src.buffer = noiseBuffer; src.loop = true;
      const bp = ac.createBiquadFilter(); bp.type='bandpass'; bp.frequency.value=250; bp.Q.value=3;
      const g  = ac.createGain(); g.gain.value=0.0001;
      src.connect(bp).connect(g).connect(radioBus);
      const now=ac.currentTime;
      radioBus.gain.cancelScheduledValues(now); radioBus.gain.setValueAtTime(1, now);
      g.gain.setValueAtTime(0.0001, now); g.gain.exponentialRampToValueAtTime(0.24, now+0.05); g.gain.exponentialRampToValueAtTime(0.0001, now+0.6);
      bp.frequency.linearRampToValueAtTime(6800, now+0.6);
      src.start(now); src.stop(now+0.64);
    }

    /* Zegar i trzaski */
    let clockCtl=null, sigilWhisperTimer=null;
    function startClock(initialMs=860){ stopClock(); let ms=initialMs; function tick(){ burst(0.11,0.04); tickTimer=setTimeout(tick, ms); } tick(); return { setRate:(n)=>{ms=Math.max(50,n);}, stop:stopClock }; }
    function stopClock(){ if(tickTimer){ clearTimeout(tickTimer); tickTimer=null; } }
    function startCrackle(rateMs=1100){ stopCrackle(); function pop(){ if(Math.random()<0.82) burst(0.09+Math.random()*0.1, 0.03+Math.random()*0.06); crackleTimer=setTimeout(pop, rateMs*(0.5+Math.random()*0.9)); } pop(); }
    function stopCrackle(){ if(crackleTimer){ clearTimeout(crackleTimer); crackleTimer=null; } }

    /* Pisanie + korupcja */
    const GLITCH=['#','%','&','/','\\','|','+','*','?','§','£','¢','¤','₧'];
    function scrollToBottom(throttle=false, i=0){ if(throttle && i%5!==0) return; wrap.scrollTop = wrap.scrollHeight; }

    function typeLine(text, speed=20, glitchChance=0.18){
      return new Promise(resolve=>{
        const line = document.createElement('div');
        const span = document.createElement('span');
        const cursor = document.createElement('span'); cursor.className='cursor';
        line.appendChild(span); line.appendChild(cursor); term.appendChild(line);

        let i=0,buf='';
        const t = setInterval(()=>{
          if(Math.random()<glitchChance && i<text.length-1){
            span.textContent = buf + GLITCH[Math.floor(Math.random()*GLITCH.length)];
            staticFx.style.opacity='0.4'; setTimeout(()=>{staticFx.style.opacity='0';},70);
            if(Math.random()<0.25) injectGlitch(1);
          }else{
            buf += text[i]||''; span.textContent = buf; i++;
          }
          scrollToBottom(true,i);
          if(i>=text.length){ clearInterval(t); cursor.remove(); scrollToBottom(false); resolve({span}); }
        }, speed);
      });
    }

    function scrambleNode(node, duration=200){
      return new Promise(resolve=>{
        const text = node.textContent; let t=0, step=16;
        const charset = "01█░▒▓<>[]{}()|/\\#%$&*+-=~^•·!?@αβΞΩπ¥₿§¶∞≡∴∵∆µøØ✓";
        const timer =
